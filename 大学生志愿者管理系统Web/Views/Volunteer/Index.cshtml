@model IEnumerable<DAL.ActivityT>
@{
    ViewBag.Title = "志愿者中心";
}

@section Styles {
    <style>
        /* 整体卡片样式 */
        .volunteer-panel {
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            margin-bottom: 20px;
            overflow: hidden;
            border: none;
        }

        /* 卡片头部 */
        .volunteer-panel-heading {
            background: linear-gradient(135deg, #FF9966, #FF5E62);
            color: white;
            padding: 20px 15px;
            border-bottom: none;
        }

        /* 个人信息卡片 */
        .profile-card {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

            .profile-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            }

        .profile-name {
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 5px;
        }

        .profile-hours {
            font-size: 16px;
            text-align: center;
            color: #6c757d;
            margin-bottom: 20px;
        }

        .profile-buttons {
            text-align: center;
        }

            .profile-buttons .btn {
                margin-bottom: 10px;
                border-radius: 30px;
                padding: 8px 20px;
                width: 100%;
            }

        /* 活动卡片 */
        .activity-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            transition: all 0.3s ease;
            overflow: hidden;
        }

            .activity-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            }

        .activity-img {
            height: 200px;
            width: 100%;
            object-fit: cover;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
        }

        .activity-body {
            padding: 15px;
        }

        .activity-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 18px;
            height: 40px;
            overflow: hidden;
        }

        .activity-info {
            color: #6c757d;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .activity-status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 12px;
            margin-bottom: 10px;
        }

        .status-ongoing {
            background-color: #28a745;
            color: white;
        }

        .status-ended {
            background-color: #dc3545;
            color: white;
        }

        .activity-footer {
            padding: 10px 15px;
            background-color: #f8f9fa;
            text-align: right;
        }

        /* 功能按钮 */
        .function-card {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            padding: 15px;
        }

        .function-title {
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #f0f0f0;
        }

        .function-buttons .btn {
            margin-bottom: 10px;
            width: 100%;
            text-align: left;
            padding: 10px 15px;
        }

        /* 搜索框 */
        .search-bar {
            margin-bottom: 20px;
        }

            .search-bar .input-group {
                border-radius: 30px;
                overflow: hidden;
            }

            .search-bar .form-control {
                border-right: 0;
            }

            .search-bar .btn {
                border-left: 0;
                background-color: white;
            }

        /* 过滤器样式 */
        .filter-badges {
            margin-bottom: 20px;
        }

        .filter-badge {
            display: inline-block;
            padding: 5px 15px;
            margin-right: 10px;
            margin-bottom: 10px;
            border-radius: 20px;
            background-color: #f8f9fa;
            color: #495057;
            cursor: pointer;
            transition: all 0.2s ease;
        }

            .filter-badge:hover, .filter-badge.active {
                background-color: #FF5E62;
                color: white;
            }

        /* 可滚动活动容器 */
        .scrollable-activities {
            max-height: 600px;
            overflow-y: auto;
            padding-right: 10px;
        }

            .scrollable-activities::-webkit-scrollbar {
                width: 6px;
            }

            .scrollable-activities::-webkit-scrollbar-track {
                background: #f1f1f1;
                border-radius: 10px;
            }

            .scrollable-activities::-webkit-scrollbar-thumb {
                background: #FF9966;
                border-radius: 10px;
            }

                .scrollable-activities::-webkit-scrollbar-thumb:hover {
                    background: #FF5E62;
                }
    </style>
}

<!-- 志愿者首页新设计 -->
<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div class="panel panel-default volunteer-panel">
                <div class="panel-heading volunteer-panel-heading">
                    <div class="row">
                        <div class="col-md-8">
                            <h2><i class="glyphicon glyphicon-heart"></i> 志愿者中心</h2>
                            <p>欢迎回来，@Session["Username"]！今天是 @DateTime.Now.ToString("yyyy年MM月dd日")</p>
                        </div>
                        <div class="col-md-4 text-right">
                            <p>您的志愿时长：<span class="label label-success">@ViewBag.VolunteerHours 小时</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- 左侧个人信息和功能按钮 -->
        <div class="col-md-3">
            <!-- 个人信息卡片 -->
            <div class="profile-card">
                <div class="profile-name">@Session["Username"]</div>
                <div class="profile-hours">志愿时长: @ViewBag.VolunteerHours 小时</div>
                <div class="profile-buttons">
                    <a href="@Url.Action("SelfCheck", "Volunteer")" class="btn btn-info">
                        <i class="glyphicon glyphicon-user"></i> 个人信息
                    </a>
                    <a href="@Url.Action("CheckIdentifyStatus", "Volunteer")" class="btn btn-warning">
                        <i class="glyphicon glyphicon-certificate"></i> 志愿者证状态
                    </a>
                    <a href="@Url.Action("Logout", "Account")" class="btn btn-danger">
                        <i class="glyphicon glyphicon-log-out"></i> 退出登录
                    </a>
                </div>
            </div>

            <!-- 功能按钮卡片 -->
            <div class="function-card">
                <div class="function-title">
                    <i class="glyphicon glyphicon-th-list"></i> 功能导航
                </div>
                <div class="function-buttons">
                    <a href="@Url.Action("Index", "Volunteer")" class="btn btn-default">
                        <i class="glyphicon glyphicon-home"></i> 活动首页
                    </a>
                    <a href="@Url.Action("MyApplications", "Volunteer")" class="btn btn-default">
                        <i class="glyphicon glyphicon-list-alt"></i> 我的申请
                    </a>
                    <a href="@Url.Action("MyActivities", "Volunteer")" class="btn btn-default">
                        <i class="glyphicon glyphicon-calendar"></i> 我的活动
                    </a>
                    <a href="@Url.Action("GetVolunteerHours", "Volunteer")" class="btn btn-default">
                        <i class="glyphicon glyphicon-time"></i> 志愿时长
                    </a>
                </div>
            </div>
        </div>

        <!-- 右侧活动列表 -->
        <div class="col-md-9">
            <!-- 搜索栏 -->
            <div class="search-bar">
                @using (Html.BeginForm("Search", "Volunteer", FormMethod.Get, new { @class = "form-inline" }))
                {
                    <div class="input-group">
                        <input type="text" class="form-control" name="keyword" placeholder="搜索活动名称..." value="@ViewBag.SearchTerm">
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="submit">
                                <i class="glyphicon glyphicon-search"></i>
                            </button>
                        </span>
                    </div>
                }
            </div>

            <!-- 过滤标签 -->
            <div class="filter-badges">
                <a href="@Url.Action("Index", "Volunteer")" class="filter-badge @(ViewBag.ActivityType == null ? "active" : "")">
                    全部活动
                </a>
                <a href="@Url.Action("Filter", "Volunteer", new { activityType = "教育类" })" class="filter-badge @(ViewBag.ActivityType == "教育类" ? "active" : "")">
                    教育类
                </a>
                <a href="@Url.Action("Filter", "Volunteer", new { activityType = "社区发展类" })" class="filter-badge @(ViewBag.ActivityType == "社区发展类" ? "active" : "")">
                    社区发展类
                </a>
                <a href="@Url.Action("Filter", "Volunteer", new { activityType = "卫生与医疗类" })" class="filter-badge @(ViewBag.ActivityType == "卫生与医疗类" ? "active" : "")">
                    卫生与医疗类
                </a>
                <a href="@Url.Action("Filter", "Volunteer", new { activityType = "环境保护类" })" class="filter-badge @(ViewBag.ActivityType == "环境保护类" ? "active" : "")">
                    环境保护类
                </a>
                <a href="@Url.Action("Filter", "Volunteer", new { activityType = "动物保护类" })" class="filter-badge @(ViewBag.ActivityType == "动物保护类" ? "active" : "")">
                    动物保护类
                </a>
            </div>

            <!-- 活动列表 - 可滚动容器 -->
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4><i class="glyphicon glyphicon-list"></i> 进行中的活动</h4>
                </div>
                <div class="panel-body scrollable-activities">
                    <div class="row">
                        @{
                            var ongoingActivities = Model != null ? Model.Where(a => a.status == "进行中").ToList() : new List<DAL.ActivityT>();
                        }

                        @if (ongoingActivities.Any())
                        {
                            foreach (var activity in ongoingActivities)
                            {
                                <div class="col-md-4">
                                    <div class="activity-card">
                                        
                                        <div class="activity-body">
                                            <div class="activity-title">@activity.activity_Name</div>
                                            <div class="activity-info">
                                                <i class="glyphicon glyphicon-tag"></i> @activity.activity_type
                                            </div>
                                            <div class="activity-info">
                                                <i class="glyphicon glyphicon-user"></i> 人数: @activity.renshu
                                            </div>
                                            <div class="activity-info">
                                                <i class="glyphicon glyphicon-calendar"></i> 截止日期:
                                                @{
                                                    var dateToDisplay = activity.stoptime != null ? activity.stoptime : (activity.stoptime != null ? activity.stoptime : DateTime.Now);
                                                    @dateToDisplay.ToString("yyyy-MM-dd")
                                                }
                                            </div>
                                            <div>
                                                <span class="activity-status status-ongoing">进行中</span>
                                            </div>
                                        </div>
                                        <div class="activity-footer">
                                            <a href="@Url.Action("ActivityDetails", "Volunteer", new { id = activity.activity_ID })" class="btn btn-primary btn-sm">
                                                <i class="glyphicon glyphicon-info-sign"></i> 查看详情
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            }
                        }
                        else
                        {
                            <div class="col-md-12">
                                <div class="alert alert-info">
                                    <i class="glyphicon glyphicon-info-sign"></i> 暂无进行中的志愿活动
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>
        $(function () {
            // 初始化工具提示
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>
}